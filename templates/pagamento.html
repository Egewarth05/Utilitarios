<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Processador de Pagamentos</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --bg:#f5f8fc;
      --card:#ffffff;
      --radius:14px;
      --shadow:0 20px 40px -10px rgba(31,78,121,0.15);
      --blue:#2752ff;
      --blue-dark:#1f3dbf;
      --radius-sm:8px;
      --transition:.35s cubic-bezier(.4,.2,.2,1);
      font-family: "Segoe UI", system-ui,-apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      background: linear-gradient(135deg,#e8eff9 0%,#f5f8fc 70%);
      min-height:100vh;
      color:#1f354d;
      -webkit-font-smoothing:antialiased;
    }
    .container{
      max-width:900px;
      margin:60px auto 40px;
      padding:1rem;
    }
    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:2rem 2.5rem 2.5rem;
      position:relative;
      overflow:hidden;
      box-shadow: var(--shadow);
      transition: var(--transition);
    }
    .card:hover{
      transform: translateY(-2px);
      box-shadow: 0 30px 60px -10px rgba(31,78,121,0.2);
    }
    h1{
      margin:0 0 6px;
      font-size:2.2rem;
      letter-spacing:0.5px;
      font-family: "Copperplate", "Copperplate Gothic", serif;
    }
    p.lead{
      margin:4px 0 24px;
      color:#4e628f;
      font-size:0.95rem;
    }
    .field{
      margin-bottom:1.5rem;
      position:relative;
    }
    label{
      display:block;
      font-weight:600;
      margin-bottom:6px;
      font-size:0.9rem;
    }
    input[type=file]{
      width:100%;
      padding:8px 12px;
      font-size:0.9rem;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:14px 28px;
      border:none;
      cursor:pointer;
      font-size:1rem;
      font-weight:600;
      border-radius:999px;
      background: linear-gradient(135deg,var(--blue), #4a7bff);
      color:#fff;
      position:relative;
      overflow:hidden;
      transition: var(--transition);
      box-shadow: 0 15px 40px -5px rgba(39,82,255,0.4);
    }
    .btn:hover{
      filter:brightness(1.05);
      transform: translateY(-1px);
    }
    .note-box{
      background: #eef5ff;
      border-left:4px solid var(--blue);
      padding:12px 16px;
      border-radius:6px;
      margin-bottom:1rem;
      font-size:0.85rem;
      display:flex;
      gap:10px;
    }
    .error{
      background:#ffe3e3;
      border:1px solid #ff8f8f;
      padding:12px 16px;
      border-radius:8px;
      color:#9b1c1c;
      margin-bottom:16px;
    }
    .success{
      background:#ebffe6;
      border:1px solid #6bcf8c;
      padding:12px 16px;
      border-radius:8px;
      color:#1f5d1f;
      margin-bottom:16px;
    }
    code {
      background:#f3f7ff;
      padding:2px 6px;
      border-radius:4px;
      font-size:0.85em;
    }
    @media (max-width: 860px){
      .card{padding:1.5rem 1.75rem;}
      h1{font-size:1.9rem;}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card" aria-label="Processador de pagamentos">
      <h1>Processador de Pagamentos</h1>
      <p class="lead">Fa√ßa o upload do arquivo Excel para formata√ß√£o ao modelo de importa√ß√£o</p>

      {% if error %}
        <div class="error">{{ error }}</div>
      {% endif %}
      {% if success %}
        <div class="success">{{ success }}</div>
      {% endif %}

      <form method="post" enctype="multipart/form-data" id="form-pagamentos">
        <div class="field">
          <label>Instru√ß√µes para a planilha antes de importar:</label>
          <div class="note-box" style="background:#f0f7ff; border-left:4px solid #2752ff;">
            <div style="flex:1;">
              <strong>O que fazer:</strong>
              <ul style="margin:8px 0 0; padding-left:18px; line-height:1.4;">
                <li>Renomeie a planilha dentro do arquivo para: <em>Pagamentos com NF Esquadrias</em> e/ou <em>Pagamentos com NF Ferro Nobre</em>.</li>
                <li>Fa√ßa upload do arquivo Excel com os pagamentos.</li>
                <li>O arquivo de sa√≠da ser√° gerado como <code>pagamentos_processados_final.xlsx</code> e ficar√° dispon√≠vel para download.</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="field">
          <label for="excel">Selecione o arquivo Excel:</label>
          <input type="file" id="excel" name="excel" accept=".xlsx,.xls" required />
        </div>

        <div style="margin-top:10px;">
          <button type="submit" class="btn">üöÄ Processar</button>
        </div>

        {% if download_link %}
          <div class="field" style="margin-top:1rem;">
            <label>Resultado:</label>
            <div>
              <a href="{{ download_link }}" class="btn" style="background: #28a745; color: white;">
                üì• Baixar arquivo processado
              </a>
            </div>
          </div>
        {% endif %}
      </form>
    </div>
  </div>
</body>
</html>
